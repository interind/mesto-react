(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{27:function(e,t,n){},28:function(e,t,n){},37:function(e,t,n){"use strict";n.r(t);var a=n(1),i=n.n(a),o=n(15),r=n.n(o),c=n(18),s=n(20),l=n(7),u=n(2),p=n(9),d=n(10),j=new(function(){function e(t){var n=t.url,a=t.token,i=t.user,o=t.cards;Object(p.a)(this,e),this._url=n,this._token=a,this._user=i,this._cards=o}return Object(d.a)(e,[{key:"_getResponse",value:function(e){return e.ok?e.json():Promise.reject(new Error("\u041e\u0448\u0438\u0431\u043a\u0430 api: ".concat(e.status)))}},{key:"getInfoForUser",value:function(){return fetch("".concat(this._url).concat(this._user),{headers:{authorization:"".concat(this._token),"Content-type":"application/json; charset=UTF-8"}}).then(this._getResponse)}},{key:"getInfoForCards",value:function(){return fetch("".concat(this._url).concat(this._cards),{headers:{authorization:"".concat(this._token),"Content-type":"application/json; charset=UTF-8"}}).then(this._getResponse)}},{key:"updateUserInfo",value:function(e){var t=e.name,n=e.about;return fetch("".concat(this._url).concat(this._user),{method:"PATCH",headers:{authorization:"".concat(this._token),"Content-type":"application/json; charset=UTF-8"},body:JSON.stringify({name:t,about:n})}).then(this._getResponse)}},{key:"updateUserAvatar",value:function(e){var t=e.avatar;return fetch("".concat(this._url).concat(this._user,"/avatar"),{method:"PATCH",headers:{authorization:"".concat(this._token),"Content-type":"application/json; charset=UTF-8"},body:JSON.stringify({avatar:t})}).then(this._getResponse)}},{key:"addCard",value:function(e){var t=e.name,n=e.link;return fetch("".concat(this._url).concat(this._cards),{method:"POST",headers:{authorization:"".concat(this._token),"Content-type":"application/json; charset=UTF-8"},body:JSON.stringify({name:t,link:n})}).then(this._getResponse)}},{key:"changeLikeCardStatus",value:function(e,t){var n=t?"PUT":"DELETE";return fetch("".concat(this._url).concat(this._cards,"/likes/").concat(e),{method:n,headers:{authorization:"".concat(this._token),"Content-type":"application/json; charset=UTF-8"}}).then(this._getResponse)}},{key:"deleteCard",value:function(e){return fetch("".concat(this._url).concat(this._cards,"/").concat(e),{method:"DELETE",headers:{authorization:"".concat(this._token),"Content-type":"application/json; charset=UTF-8"}}).then(this._getResponse)}}]),e}())({url:"https://mesto.nomoreparties.co/v1/cohort-16/",token:"bba27b67-a97d-4fd9-b42d-01c5b1258337",user:"users/me",cards:"cards"}),b=i.a.createContext(),h=n(0);var m=function(e){var t=e.card,n=e.onCardClick,a=e.onCardDelete,o=e.onCardLike,r=i.a.useContext(b)._id,c=i.a.useState(!0),s=Object(u.a)(c,2),l=s[0],p=s[1];return Object(h.jsx)(i.a.Fragment,{children:l&&Object(h.jsxs)("div",{className:"element",children:[Object(h.jsx)("img",{className:"element__pic",src:t.link,alt:t.name,onError:function(){p(!1)},onClick:function(){return n(t)}}),Object(h.jsx)("button",{className:"element__button-trash ".concat(t.owner&&(t.owner._id===r?"element__button-trash_visible":"")),type:"button",title:"\u043a\u043d\u043e\u043f\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438",onClick:function(){return a(t)}}),Object(h.jsxs)("div",{className:"element__info",children:[Object(h.jsx)("h2",{className:"element__title",title:t.name,children:t.name}),t.likes&&Object(h.jsxs)("div",{className:"element__like",children:[Object(h.jsx)("button",{className:"element__button-like element__button-like_color_white ".concat(t.likes.find((function(e){return e._id===r}))?"element__button-like_color_black":""),type:"button",title:"\u043a\u043d\u043e\u043f\u043a\u0430 \u0434\u043b\u044f \u043b\u0430\u0439\u043a\u043e\u0432",onClick:function(){return o(t)}}),Object(h.jsx)("span",{className:"element__counter-like",title:t.likes.map((function(e,t){return t+1+"\ud83d\udda4"+e.name})),children:t.likes.length})]})]})]})})},f=n(16),_=n.n(f);var v=function(e){var t=e.name,n=e.isOpen,a=e.onClose,i=e.children,o=_()("popup popup_type_".concat(t),{popup_opened:n});return Object(h.jsx)("div",{className:o,onMouseDown:function(e){e.currentTarget===e.target&&a()},children:i})};var O=function(e){var t=e.selectedCard,n=e.onClose;return Object(h.jsx)(v,{name:"zoom",isOpen:t,onClose:n,children:t&&Object(h.jsxs)("div",{className:"popup__zoom",children:[Object(h.jsx)("img",{className:"popup__pic",src:t.link,alt:t.name}),Object(h.jsx)("span",{className:"popup__place-pic",children:t.name}),Object(h.jsx)("button",{className:"popup__button-close",type:"button",title:"\u0437\u0430\u043a\u0440\u044b\u0442\u044c",onClick:n})]})})};var g=function(e){var t=e.onEditAvatar,n=e.onEditProfile,a=e.onAddPlace,o=e.handleCardDelete,r=e.closeAllPopups,c=e.handleCardClick,s=e.selectedCard,l=e.cards,u=e.handleCardLike,p=i.a.useContext(b),d=p.name,j=p.about,f=p.avatar,_=p._id;return Object(h.jsxs)(i.a.Fragment,{children:[Object(h.jsxs)("section",{className:"profile page__profile",children:[Object(h.jsx)("img",{className:"profile__avatar",src:f,alt:"\u0410\u0432\u0430\u0442\u0430\u0440\u043a\u0430",id:_,onClick:t}),Object(h.jsxs)("div",{className:"profile__info",children:[Object(h.jsx)("h1",{className:"profile__title",title:d,children:d}),Object(h.jsx)("button",{className:"profile__edit-button",type:"button",title:"\u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u0440\u043e\u0444\u0438\u043b\u044f",onClick:n}),Object(h.jsx)("p",{className:"profile__subtitle",title:j,children:j})]}),Object(h.jsx)("button",{className:"profile__add-button",type:"button",title:"\u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0438",onClick:a})]}),Object(h.jsx)("div",{className:"elements page__elements",children:l.map((function(e){return Object(h.jsx)(m,{onCardDelete:o,card:e,onCardClick:c,onCardLike:u},e.createdAt+e._id)}))}),Object(h.jsx)(O,{selectedCard:s,onClose:r})]})},x=n.p+"static/media/logoFon.8724261e.svg";var C=function(){return Object(h.jsx)("header",{className:"header page__header",children:Object(h.jsx)("img",{className:"logo header__logo",src:x,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f"})})};var k=function(){return Object(h.jsx)("footer",{className:"footer page__footer",children:Object(h.jsxs)("p",{className:"footer__copyright",children:["\xa9",(new Date).getFullYear()," Mesto Russia"]})})};n(27);var y=function(){return Object(h.jsx)("div",{className:"lds-dual-ring"})},N=n(4);var S=function(e){var t=e.active,n=e.name,a=e.title,o=e.onSubmit,r=e.buttonTitle,c=e.onClose,s=e.isOpen,l=e.children,u=t?"disabled":"",p=t?"popup__button-submit_disabled":"";return Object(h.jsx)(i.a.Fragment,{children:Object(h.jsx)(v,{name:n,isOpen:s,onClose:c,children:Object(h.jsxs)("form",{className:"popup__container popup__container_type_".concat(n),name:n,onSubmit:o,children:[Object(h.jsx)("h2",{className:"popup__title",children:a}),l,Object(h.jsx)("button",{className:"popup__button-submit ".concat(p),type:"submit",title:r,disabled:u,children:r}),Object(h.jsx)("button",{className:"popup__button-close",type:"button",title:"\u0437\u0430\u043a\u0440\u044b\u0442\u044c",onClick:c})]})})})},T=function(e){return Object(h.jsxs)(i.a.Fragment,{children:[Object(h.jsx)("input",{className:"popup__input",type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",id:"input-avatar",name:"avatar",value:e.avatarUser,ref:e.inputRef,onChange:e.editAvatar,onInput:e.validationAvatar,required:!0}),""!==e.avatar&&Object(h.jsx)("div",{className:"popup__error",children:Object(h.jsx)("span",{className:"popup__input-error popup__input-error_active",id:"input-avatar-error ",children:e.avatarMessage})})]})},L=function(e){return Object(h.jsxs)(i.a.Fragment,{children:[Object(h.jsx)("input",{className:"popup__input",id:"input-name",type:"text",name:"name",minLength:"2",maxLength:"40",placeholder:"\u0418\u043c\u044f",value:e.nameProfile,onChange:e.editName,onInput:e.validationProfile,required:!0}),""===e.nameProfile&&Object(h.jsx)("div",{className:"popup__error",children:Object(h.jsx)("span",{className:"popup__input-error popup__input-error_active",id:"input-name-error",children:e.profileMessage.name})}),Object(h.jsx)("input",{className:"popup__input",id:"input-about",type:"text",name:"about",minLength:"2",maxLength:"200",placeholder:"\u041f\u0440\u043e\u0444\u0435\u0441\u0441\u0438\u044f",value:e.about,onChange:e.editAbout,onInput:e.validationProfile,required:!0}),""===e.about&&Object(h.jsx)("div",{className:"popup__error",children:Object(h.jsx)("span",{className:"popup__input-error popup__input-error_active",id:"input-about-error",children:e.profileMessage.about})})]})},P=function(e){return Object(h.jsxs)(i.a.Fragment,{children:[Object(h.jsx)("input",{className:"popup__input",type:"text",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",id:"input-place",name:"place",minLength:"1",value:e.place,maxLength:"30",onChange:e.editPlace,onInput:e.validationPlace,required:!0}),""===e.place&&Object(h.jsx)("div",{className:"popup__error",children:Object(h.jsx)("span",{className:"popup__input-error popup__input-error_active",id:"input-place-error",children:e.placeMessage.place})}),Object(h.jsx)("input",{className:"popup__input",type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",id:"input-link",value:e.link,name:"link",onChange:e.editLink,onInput:e.validationPlace,required:!0}),""!==e.link&&Object(h.jsx)("div",{className:"popup__error",children:Object(h.jsx)("span",{className:"popup__input-error popup__input-error_active",id:"input-link-error",children:e.placeMessage.link})})]})};var F=function(e){var t=e.isLoadingButton,n=e.isOpen,a=e.onClose,o=e.onAddPlace,r={id:3,name:"place",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",buttonTitle:"".concat(t?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")},c=i.a.useState(""),s=Object(u.a)(c,2),l=s[0],p=s[1],d=i.a.useState(""),j=Object(u.a)(d,2),b=j[0],m=j[1],f=i.a.useState(!0),_=Object(u.a)(f,2),v=_[0],O=_[1],g=i.a.useState({place:"",link:""}),x=Object(u.a)(g,2),C=x[0],k=x[1];return Object(h.jsx)(S,{name:r.name,title:r.title,buttonTitle:r.buttonTitle,isOpen:n,onClose:a,active:v,onSubmit:function(e){e.preventDefault(),p(""),m(""),o({name:l,link:b})},children:Object(h.jsx)(P,{place:l,link:b,editPlace:function(e){p(e.target.value),O(!e.target.value)},editLink:function(e){m(e.target.value),O(!e.target.value)},placeMessage:C,validationPlace:function(e){e.target.validity.valid?k(Object(N.a)({},e.target.name,"")):k(Object(N.a)({},e.target.name,e.target.validationMessage))}})},r.id)};var U=function(e){var t=e.isLoadingButton,n=e.isOpen,a=e.onClose,i=e.onDeleteCard,o=e.isCard,r={id:4,name:"trash",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",buttonTitle:"".concat(t?"\u0423\u0434\u0430\u043b\u044f\u0435\u043c...":"\u0414\u0430")};return Object(h.jsx)(S,{name:r.name,title:r.title,buttonTitle:r.buttonTitle,isOpen:n,onClose:a,onSubmit:function(e){e.preventDefault(),i(o)}},r.id)},A=n(21),E=n(19),w=function(e){Object(A.a)(n,e);var t=Object(E.a)(n);function n(e){var a;return Object(p.a)(this,n),(a=t.call(this,e)).state={error:null,errorInfo:null},a}return Object(d.a)(n,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e,errorInfo:t})}},{key:"render",value:function(){return this.state.errorInfo?Object(h.jsxs)("div",{children:[Object(h.jsx)("h2",{children:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a!"}),Object(h.jsxs)("details",{style:{whiteSpace:"pre-wrap"},children:[this.state.error&&this.state.error.toString(),Object(h.jsx)("br",{}),this.state.errorInfo.componentStack]})]}):this.props.children}}]),n}(i.a.Component);var D=function(e){var t=e.isLoadingButton,n=e.isOpen,a=e.onClose,o=e.onUpdateAvatar,r={id:1,name:"avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",buttonTitle:"".concat(t?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")},c=i.a.useRef(),s=i.a.useState(""),l=Object(u.a)(s,2),p=l[0],d=l[1],j=i.a.useState(!0),b=Object(u.a)(j,2),m=b[0],f=b[1],_=i.a.useState(""),v=Object(u.a)(_,2),O=v[0],g=v[1];return Object(h.jsx)(S,{name:r.name,title:r.title,buttonTitle:r.buttonTitle,isOpen:n,onClose:a,onSubmit:function(e){e.preventDefault(),d(""),o({avatar:p})},active:m,children:Object(h.jsx)(T,{avatarUser:p,inputRef:c,editAvatar:function(){d(c.current.value),f(!c.current.value)},avatarMessage:O,validationAvatar:function(e){e.target.validity.valid?g(""):g(e.target.validationMessage)}})},r.id)};var I=function(e){var t=e.isLoadingButton,n=e.isOpen,a=e.onClose,o=e.onUpdateUser,r={id:2,name:"profile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0444\u043e\u0440\u043c\u0443",buttonTitle:"".concat(t?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")},c=i.a.useContext(b),s=i.a.useState({name:""}),l=Object(u.a)(s,2),p=l[0],d=l[1],j=i.a.useState({about:""}),m=Object(u.a)(j,2),f=m[0],_=m[1],v=i.a.useState(!0),O=Object(u.a)(v,2),g=O[0],x=O[1],C=i.a.useState({name:"",about:""}),k=Object(u.a)(C,2),y=k[0],T=k[1];return i.a.useEffect((function(){d(c.name),_(c.about)}),[c]),Object(h.jsx)(S,{name:r.name,title:r.title,buttonTitle:r.buttonTitle,isOpen:n,onClose:a,onSubmit:function(e){e.preventDefault(),o({name:p,about:f})},active:g,children:Object(h.jsx)(L,{editName:function(e){d(e.target.value),x(!e.target.value)},editAbout:function(e){_(e.target.value),x(!e.target.value)},nameProfile:p,about:f,profileMessage:y,validationProfile:function(e){e.target.validity.valid?T(Object(N.a)({},e.target.name,"")):T(Object(N.a)({},e.target.name,e.target.validationMessage))}})},r.id)};function M(e){var t=e.error;return Object(h.jsx)(i.a.Fragment,{children:Object(h.jsxs)("div",{style:{color:"#f00",display:"flex",flexDirection:"column","justify-content":"center","align-items":"center",minHeight:"60vh"},children:[Object(h.jsx)("h1",{children:t.message}),Object(h.jsx)("p",{style:{color:"#fff"},children:"\u043f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0437\u0430\u0439\u0442\u0438 \u043f\u043e\u0437\u0436\u0435"})]})})}var R=function(){var e=i.a.useState({}),t=Object(u.a)(e,2),n=t[0],a=t[1],o=i.a.useState(!1),r=Object(u.a)(o,2),c=r[0],p=r[1],d=i.a.useState(!1),m=Object(u.a)(d,2),f=m[0],_=m[1],v=i.a.useState(!1),O=Object(u.a)(v,2),x=O[0],N=O[1],S=i.a.useState(!1),T=Object(u.a)(S,2),L=T[0],P=T[1],A=i.a.useState({name:"",about:"",_id:"",avatar:""}),E=Object(u.a)(A,2),R=E[0],z=E[1],B=i.a.useState([]),q=Object(u.a)(B,2),J=q[0],H=q[1],Y=i.a.useState(!0),G=Object(u.a)(Y,2),K=G[0],Q=G[1],V=i.a.useState(!0),W=Object(u.a)(V,2),X=W[0],Z=W[1],$=i.a.useState({}),ee=Object(u.a)($,2),te=ee[0],ne=ee[1],ae=i.a.useState(),ie=Object(u.a)(ae,2),oe=ie[0],re=ie[1],ce=i.a.useState(!1),se=Object(u.a)(ce,2),le=se[0],ue=se[1];function pe(){_(!1),N(!1),p(!1),P(!1),re(void 0),ue(!1)}function de(e){"Escape"===e.key&&pe()}return i.a.useEffect((function(){return window.addEventListener("keydown",de),function(){window.removeEventListener("keydown",de)}})),i.a.useEffect((function(){Promise.all([j.getInfoForUser(),j.getInfoForCards()]).then((function(e){var t=Object(u.a)(e,2),n=t[0],a=t[1];z(n),H(a)})).catch((function(e){console.error("\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u0441 \u043e\u0448\u0438\u0431\u043a\u043e\u0439",e.message),ne(e),Z(!1)})).finally((function(){Q(!1)}))}),[]),Object(h.jsx)(i.a.Fragment,{children:Object(h.jsx)("div",{className:"page",children:Object(h.jsx)(b.Provider,{value:R,children:Object(h.jsxs)(w,{children:[Object(h.jsx)(C,{}),K&&Object(h.jsx)(y,{}),X?Object(h.jsxs)(i.a.Fragment,{children:[Object(h.jsx)(g,{onEditProfile:function(){N(!0)},onEditAvatar:function(){_(!0)},onAddPlace:function(){p(!0)},handleCardDelete:function(e){P(!0),a(e)},closeAllPopups:pe,handleCardClick:function(e){var t=e.name,n=e.link;re({link:n,name:t})},selectedCard:oe,handleCardLike:function(e){var t=e.likes,n=e._id,a=t.some((function(e){return e._id===R._id}));j.changeLikeCardStatus(n,!a).then((function(e){var t=J.map((function(t){return t._id===n?e:t}));H(t)})).catch((function(e){return console.error("\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043f\u043e \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0430\u043c \u0441 \u043e\u0448\u0438\u0431\u043a\u043e\u0439",e.message)}))},cards:J,statusOk:X}),Object(h.jsx)(F,{isOpen:c,onClose:pe,onAddPlace:function(e){var t=e.name,n=e.link;ue(!0),j.addCard({name:t,link:n}).then((function(e){H([e].concat(Object(s.a)(J)))})).catch((function(e){return console.error("\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438 \u0441 \u043e\u0448\u0438\u0431\u043a\u043e\u0439",e)})).finally((function(){pe()}))},isLoadingButton:le}),Object(h.jsx)(D,{isOpen:f,onClose:pe,onUpdateAvatar:function(e){var t=e.avatar;ue(!0),j.updateUserAvatar({avatar:t}).then((function(e){z(Object(l.a)(Object(l.a)({},R),{},{avatar:e.avatar}))})).catch((function(e){return console.error("\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0441 \u043e\u0448\u0438\u0431\u043a\u043e\u0439",e)})).finally((function(){pe()}))},isLoadingButton:le}),Object(h.jsx)(I,{isOpen:x,onClose:pe,onUpdateUser:function(e){var t=e.name,n=e.about;ue(!0),j.updateUserInfo({name:t,about:n}).then((function(e){z(Object(l.a)(Object(l.a)({},R),{},{name:e.name,about:e.about}))})).catch((function(e){return console.error("\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0441 \u043e\u0448\u0438\u0431\u043a\u043e\u0439",e)})).finally((function(){pe()}))},isLoadingButton:le}),Object(h.jsx)(U,{isOpen:L,onClose:pe,onDeleteCard:function(e){var t=e._id,n=t;ue(!0),j.deleteCard(t).then((function(){H(J.filter((function(e){return e._id!==n})))})).catch((function(e){return console.error("\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043f\u043e \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0430\u043c \u0441 \u043e\u0448\u0438\u0431\u043a\u043e\u0439",e.message)})).finally((function(){pe()}))},isCard:n,isLoadingButton:le})]}):Object(h.jsx)(M,{error:te}),Object(h.jsx)(k,{})]})})})})};n(28);r.a.render(Object(h.jsx)(i.a.StrictMode,{children:Object(h.jsx)(c.a,{children:Object(h.jsx)(R,{})})}),document.getElementById("root"))}},[[37,1,2]]]);
//# sourceMappingURL=main.1e404697.chunk.js.map